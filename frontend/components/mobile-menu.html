<!-- Mobile Hamburger Menu -->
<button class="hamburger-menu" id="hamburger-menu" onclick="toggleMobileMenu()" aria-label="Toggle menu">
  <span></span>
  <span></span>
  <span></span>
</button>

<div class="mobile-menu-overlay" id="mobile-menu-overlay" onclick="closeMobileMenu()"></div>

<nav class="mobile-menu-sidebar" id="mobile-menu-sidebar">
  <div class="mobile-menu-header">
    <img src="../mj-images/mj-logo.gif" alt="MJE Logo" style="height: 40px; width: auto; object-fit: contain; max-width: 150px;">
    <button class="mobile-menu-close" onclick="closeMobileMenu()" aria-label="Close menu">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <div class="mobile-menu-content">
    <!-- User Info (if logged in) -->
    <div class="mobile-menu-user auth-link" style="display:none;">
      <div class="mobile-menu-user-avatar">
        <i class="fas fa-user-circle"></i>
      </div>
      <div class="mobile-menu-user-info">
        <strong id="mobile-menu-username">Loading...</strong>
        <small id="mobile-menu-user-email">Loading...</small>
      </div>
    </div>

    <!-- Main Navigation -->
    <ul class="mobile-menu-links">
      <li><a href="index.html"><i class="fas fa-home"></i> Home</a></li>
      <li><a href="products.html"><i class="fas fa-box"></i> Products</a></li>
      <li><a href="categories.html"><i class="fas fa-th"></i> Categories</a></li>
      <li><a href="about.html"><i class="fas fa-info-circle"></i> About Us</a></li>
      <li><a href="contact.html"><i class="fas fa-phone"></i> Contact</a></li>
      <li><a href="about.html#faq"><i class="fas fa-question-circle"></i> FAQ</a></li>
    </ul>

    <!-- Auth Links -->
    <ul class="mobile-menu-links mobile-menu-auth">
      <li class="auth-link" style="display:none;">
        <a href="cart.html">
          <i class="fas fa-shopping-cart"></i> Cart
          <span class="mobile-menu-badge" id="mobile-menu-cart-badge">0</span>
        </a>
      </li>
      <li class="auth-link" style="display:none;">
        <a href="wishlist.html">
          <i class="fas fa-heart"></i> Wishlist
          <span class="mobile-menu-badge" id="mobile-menu-wishlist-badge">0</span>
        </a>
      </li>
      <li class="auth-link" style="display:none;">
        <a href="compare.html">
          <i class="fas fa-balance-scale"></i> Compare
          <span class="mobile-menu-badge" id="mobile-menu-compare-badge">0</span>
        </a>
      </li>
      <li class="auth-link" style="display:none;">
        <a href="user-dashboard.html"><i class="fas fa-user"></i> My Account</a>
      </li>
      <li class="auth-link" style="display:none;">
        <a href="#" onclick="handleLogout(); return false;">
          <i class="fas fa-sign-out-alt"></i> Logout
        </a>
      </li>
      <li class="guest-link">
        <a href="login.html"><i class="fas fa-sign-in-alt"></i> Login</a>
      </li>
      <li class="guest-link">
        <a href="register.html"><i class="fas fa-user-plus"></i> Register</a>
      </li>
    </ul>

    <!-- Support Info -->
    <div class="mobile-menu-support">
      <div class="mobile-menu-support-item">
        <i class="fas fa-phone-alt"></i>
        <div>
          <strong>24/7 Support</strong>
          <small>+233 597528733</small>
        </div>
      </div>
    </div>
  </div>
</nav>

<script>
function toggleMobileMenu() {
  const sidebar = document.getElementById('mobile-menu-sidebar');
  const overlay = document.getElementById('mobile-menu-overlay');
  const hamburger = document.getElementById('hamburger-menu');
  
  sidebar.classList.toggle('active');
  overlay.classList.toggle('active');
  hamburger.classList.toggle('active');
  document.body.classList.toggle('menu-open');
}

function closeMobileMenu() {
  const sidebar = document.getElementById('mobile-menu-sidebar');
  const overlay = document.getElementById('mobile-menu-overlay');
  const hamburger = document.getElementById('hamburger-menu');
  
  sidebar.classList.remove('active');
  overlay.classList.remove('active');
  hamburger.classList.remove('active');
  document.body.classList.remove('menu-open');
}

// Update mobile menu user info when auth state changes
function updateMobileMenuAuth() {
  const state = stateManager?.getState();
  const username = document.getElementById('mobile-menu-username');
  const email = document.getElementById('mobile-menu-user-email');
  
  if (state && state.isAuthenticated && state.user) {
    if (username) username.textContent = state.user.name || 'User';
    if (email) email.textContent = state.user.email || '';
  } else {
    if (username) username.textContent = 'Loading...';
    if (email) email.textContent = 'Loading...';
  }
  
  // Update badges
  updateMobileMenuBadges();
}

function updateMobileMenuBadges() {
  const cartBadge = document.getElementById('mobile-menu-cart-badge');
  const wishlistBadge = document.getElementById('mobile-menu-wishlist-badge');
  const compareBadge = document.getElementById('mobile-menu-compare-badge');
  
  if (cartBadge && typeof stateManager !== 'undefined') {
    const cartCount = stateManager.getCartCount();
    cartBadge.textContent = cartCount;
    cartBadge.style.display = cartCount > 0 ? 'inline-block' : 'none';
  }
  
  if (wishlistBadge && typeof wishlistManager !== 'undefined') {
    const wishlistCount = wishlistManager.getWishlistCount();
    wishlistBadge.textContent = wishlistCount;
    wishlistBadge.style.display = wishlistCount > 0 ? 'inline-block' : 'none';
  }
  
  if (compareBadge && typeof compareManager !== 'undefined') {
    const compareCount = compareManager.getCompareCount();
    compareBadge.textContent = compareCount;
    compareBadge.style.display = compareCount > 0 ? 'inline-block' : 'none';
  }
}

// Call this when menu opens
function toggleMobileMenu() {
  const sidebar = document.getElementById('mobile-menu-sidebar');
  const overlay = document.getElementById('mobile-menu-overlay');
  const hamburger = document.getElementById('hamburger-menu');
  
  sidebar.classList.toggle('active');
  overlay.classList.toggle('active');
  hamburger.classList.toggle('active');
  document.body.classList.toggle('menu-open');
  
  // Update user data when menu opens
  if (sidebar.classList.contains('active')) {
    updateMobileMenuAuth();
  }
}
</script>
